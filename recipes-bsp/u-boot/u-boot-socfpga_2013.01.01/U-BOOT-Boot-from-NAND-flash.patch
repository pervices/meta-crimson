From 9bd0329727c191a542c32a96bf66a32a8290f075 Mon Sep 17 00:00:00 2001
From: "Build @Spectrum" <cfri@roxy>
Date: Fri, 25 May 2018 18:11:02 +0000
Subject: [PATCH] NAND: Enbale NAND in UBOOT

---
 board/altera/socfpga/build.h     |  4 ++--
 include/configs/socfpga_common.h | 10 +++++++++-
 2 files changed, 11 insertions(+), 3 deletions(-)

diff --git a/board/altera/socfpga/build.h b/board/altera/socfpga/build.h
index c1f10c0..ebacf39 100644
--- a/board/altera/socfpga/build.h
+++ b/board/altera/socfpga/build.h
@@ -36,8 +36,8 @@
  * Only 1 boot option to be enabled at any time
  */
 #define CONFIG_PRELOADER_BOOT_FROM_QSPI		(0)
-#define CONFIG_PRELOADER_BOOT_FROM_SDMMC	(1)
-#define CONFIG_PRELOADER_BOOT_FROM_NAND		(0)
+#define CONFIG_PRELOADER_BOOT_FROM_SDMMC	(0)
+#define CONFIG_PRELOADER_BOOT_FROM_NAND		(1)
 #define CONFIG_PRELOADER_BOOT_FROM_RAM		(0)
 
 /*
diff --git a/include/configs/socfpga_common.h b/include/configs/socfpga_common.h
index 6d1424a..9495e3b 100644
--- a/include/configs/socfpga_common.h
+++ b/include/configs/socfpga_common.h
@@ -98,7 +98,7 @@
 /* Room required on the stack for the environment data */
 #define CONFIG_ENV_SIZE			4096
 /* Size of DRAM reserved for malloc() use */
-#define CONFIG_SYS_MALLOC_LEN		(CONFIG_ENV_SIZE + 256 * 1024)
+#define CONFIG_SYS_MALLOC_LEN		(CONFIG_ENV_SIZE + 1024 * 1024)
 
 /*
  * Stack setup
@@ -513,6 +513,14 @@
 #define CONFIG_NAND_DENALI
 #endif
 #ifdef CONFIG_NAND_DENALI
+#define CONFIG_CMD_UBI
+#define CONFIG_CMD_UBIFS
+#define CONFIG_CMD_CONFIG_RBTREE
+#define CONFIG_LZO
+#define CONFIG_CMD_UBI
+#define CONFIG_CMD_UBIFS
+#define CONFIG_CMD_CONFIG_RBTREE
+#define CONFIG_LZO
 #define CONFIG_CMD_NAND
 #define CONFIG_SYS_MAX_NAND_DEVICE	1
 #define CONFIG_SYS_NAND_USE_FLASH_BBT
-- 
2.7.4

